---
phase: 03-scientific-ui-panel
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ScientificPanel.tsx
  - src/components/Calculator.tsx
  - src/components/ButtonPanel.tsx
  - src/App.tsx
  - src/styles/Calculator.css
autonomous: false

must_haves:
  truths:
    - "User can toggle scientific button panel on/off with a visible control"
    - "Scientific panel slides out smoothly without disrupting calculator state"
    - "Basic calculator view remains clean when scientific panel is hidden"
    - "Toggling the panel preserves all calculator state (expression, memory, history, mode)"
  artifacts:
    - path: "src/components/ScientificPanel.tsx"
      provides: "Grid of scientific function buttons"
      min_lines: 30
    - path: "src/styles/Calculator.css"
      provides: "Scientific panel styles with slide animation"
      contains: "scientific-panel"
  key_links:
    - from: "src/components/ScientificPanel.tsx"
      to: "src/App.tsx"
      via: "onButtonClick prop"
      pattern: "onButtonClick"
    - from: "src/components/Calculator.tsx"
      to: "src/components/ScientificPanel.tsx"
      via: "conditional render with toggle state"
      pattern: "ScientificPanel"
---

<objective>
Build a toggle scientific button panel that slides open beside the basic calculator, giving users quick access to all scientific functions without cluttering the basic view.

Purpose: Scientific functions already work via keyboard/autocomplete (Phase 2), but most users expect clickable buttons. A toggle panel keeps the basic calculator clean while making scientific functions discoverable.
Output: ScientificPanel component, toggle control, slide animation, full wiring into Calculator.
</objective>

<execution_context>
@/Users/angel-ai/.claude/get-shit-done/workflows/execute-plan.md
@/Users/angel-ai/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-scientific-functions/02-02-SUMMARY.md
@src/components/Calculator.tsx
@src/components/ButtonPanel.tsx
@src/App.tsx
@src/styles/Calculator.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ScientificPanel component and toggle state</name>
  <files>
    src/components/ScientificPanel.tsx
    src/components/Calculator.tsx
    src/App.tsx
  </files>
  <action>
Create `src/components/ScientificPanel.tsx`:
- Props: `{ onButtonClick: (value: string) => void; visible: boolean }`
- Render a grid of scientific function buttons organized in logical groups:
  - Row 1: sin, cos, tan, π (pi)
  - Row 2: asin, acos, atan, e
  - Row 3: sinh, cosh, tanh, x!
  - Row 4: log, ln, sqrt, x^y
  - Row 5: abs, cbrt, (, )
- Each button uses the existing `Button` component from `./Button`
- Button click calls `onButtonClick` with the function name string (e.g. 'sin', 'cos', 'pi', 'e_constant', '!', '^', '(', ')')
- These values already work because App.tsx handles them in expression mode (Phase 2 wired this)
- The panel wrapper div has className `scientific-panel` plus `scientific-panel--visible` when `visible` is true
- Apply `btn--scientific` className to all buttons in the panel for distinct styling

Add `scientificPanelOpen` state to `src/App.tsx`:
- `const [scientificPanelOpen, setScientificPanelOpen] = useState(false)`
- `const handleScientificToggle = useCallback(() => setScientificPanelOpen(prev => !prev), [])`
- Pass `scientificPanelOpen` and `onScientificToggle` to Calculator component
- IMPORTANT: toggling panel does NOT touch any calculator state (expression, memory, history, mode)

Update `src/components/Calculator.tsx`:
- Add `scientificPanelOpen` and `onScientificToggle` props to CalculatorProps interface
- Add a toggle button above or below the mode toggle: a small button with label "SCI" or a ≡-like icon that toggles the scientific panel
- Use className `scientific-toggle` for the toggle button, add `scientific-toggle--active` when panel is open
- Render `ScientificPanel` component inside the calculator div, positioned to the LEFT of the button panel
- Wrap ButtonPanel and ScientificPanel in a flex container: `<div className="calculator__panels">` with ScientificPanel on the left, ButtonPanel on the right
- Pass `onButtonClick` to ScientificPanel (same handler as ButtonPanel)

Note: The scientific panel buttons work ONLY in expression mode. When in simple mode, the buttons still fire onButtonClick but App.tsx's simple mode handler ignores unknown values (no crash, just no-op). This is acceptable — no guard needed.
  </action>
  <verify>
Run `npm run build` — TypeScript compilation succeeds with no errors.
Run `npx vitest run` — all existing tests still pass (no regression).
  </verify>
  <done>
ScientificPanel component renders a 4-column grid of 20 scientific buttons. Calculator shows a toggle button. Clicking toggle shows/hides the scientific panel. All calculator state is preserved when toggling.
  </done>
</task>

<task type="auto">
  <name>Task 2: Style scientific panel with slide animation and responsive design</name>
  <files>
    src/styles/Calculator.css
  </files>
  <action>
Add CSS for the scientific panel to `src/styles/Calculator.css`:

**Calculator container adjustment:**
- `.calculator` max-width should expand when panel is open. Use a wrapper approach: the Calculator component's outer div gets an additional class `calculator--sci-open` when panel is visible, which increases max-width to accommodate the panel (e.g., ~580px to fit both panels side by side).

**Panel layout:**
- `.calculator__panels` — flex container, `display: flex; gap: 8px;`
- `.scientific-panel` — hidden by default with `width: 0; overflow: hidden; opacity: 0; transition: width 0.25s ease, opacity 0.2s ease;`
- `.scientific-panel--visible` — `width: 180px; opacity: 1;` (slides open from left)
- Inside the panel, a `.scientific-panel__grid` with `display: grid; grid-template-columns: repeat(4, 1fr); gap: 4px;`

**Button styling:**
- `.btn--scientific` — smaller font size (~0.8rem), reduced padding (~10px 4px), background #3a4a5a (blue-gray tint to distinguish from basic buttons), white text
- `.btn--scientific:hover` — lighter background #4a5a6a
- `.btn--scientific:active` — darker background #2a3a4a

**Toggle button:**
- `.scientific-toggle` — small button above the panels area, background transparent or subtle, text "SCI", font-size 0.75rem, padding 4px 10px, border-radius 4px, color #888
- `.scientific-toggle:hover` — color #aaa, background rgba(255,255,255,0.05)
- `.scientific-toggle--active` — color #4a9eff (blue accent to indicate active state), background rgba(74,158,255,0.1)

**Responsive:**
- At <=480px (phone): Scientific panel appears ABOVE the button panel instead of beside it (flex-direction: column-reverse on `.calculator__panels`). Panel width becomes 100% when visible. Calculator max-width stays 100%.
- At <=340px (narrow phone): Reduce scientific button font-size and padding further.
  </action>
  <verify>
Run `npm run build` — build succeeds.
Visually verify in browser: panel slides open/closed smoothly, buttons are styled distinctly, responsive layout works at phone widths.
  </verify>
  <done>
Scientific panel slides in from the left with smooth CSS transition. Panel buttons are visually distinct from basic calculator buttons. On mobile, panel stacks above basic buttons. Calculator container expands to accommodate panel without layout shift.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Verify scientific panel UI</name>
  <action>Human verification of the scientific toggle panel</action>
  <what-built>Scientific toggle panel with all function buttons, slide animation, and responsive layout</what-built>
  <how-to-verify>
    1. Run `npm run dev` and open the calculator in your browser
    2. Verify the basic calculator looks unchanged (no scientific panel visible)
    3. Click the "SCI" toggle button — the scientific panel should slide open to the LEFT of the basic buttons
    4. Verify all 20 scientific buttons are visible (sin, cos, tan, pi, asin, acos, atan, e, sinh, cosh, tanh, x!, log, ln, sqrt, x^y, abs, cbrt, (, ))
    5. Switch to Expression mode, then click a scientific function button (e.g., sin) — it should insert `sin()` into the expression
    6. Type a number and press = to verify the function evaluates correctly
    7. Toggle the SCI panel closed — verify all calculator state (expression, result, memory, history) is preserved
    8. Resize browser to mobile width (~375px) — verify the scientific panel appears ABOVE the basic buttons instead of beside them
    9. Toggle SCI panel on/off at mobile width — verify smooth animation
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues</resume-signal>
</task>

</tasks>

<verification>
- `npm run build` succeeds
- `npx vitest run` — all existing tests pass (no regressions)
- Scientific panel renders with all function buttons
- Toggle button shows/hides panel with smooth CSS transition
- Calculator state is fully preserved across panel toggle
- Responsive layout works on mobile (panel stacks above buttons)
</verification>

<success_criteria>
- Scientific toggle panel is accessible via "SCI" button
- Panel slides open smoothly to show 20 scientific function buttons
- Clicking function buttons inserts functions into expressions (expression mode)
- Basic calculator remains clean and unchanged when panel is hidden
- All calculator state survives panel toggle (expression, memory, history, angle mode)
- Mobile layout stacks panel above basic buttons
</success_criteria>

<output>
After completion, create `.planning/phases/03-scientific-ui-panel/03-01-SUMMARY.md`
</output>
